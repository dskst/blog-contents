---
title: "Bookmarklet ã§ TeamSprit ã®ç”³è«‹ã‚’ä¸€æ‹¬æ‰¿èªã™ã‚‹"
emoji: "ğŸ”–"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["bookmarklet","JavaScript"]
published: true 
---

[TeamSprit](https://www.teamspirit.com/ja-jp/service/ts/) ã¨ã„ã†ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ„ãƒ¼ãƒ«ã«ã¦ã€ç”³è«‹ã®ã‚ã£ãŸãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ä¸€æ‹¬ã§æ‰¿èªã™ã‚‹ Bookmarklet ã§ã™ã€‚

![æœªæ‰¿èªä¸€è¦§](https://storage.googleapis.com/zenn-user-upload/08j0yeos3s84xg0615nvqx1j7ksc)

æœªæ‰¿èªä¸€è¦§ãŒã“ã‚“ãªã«æºœã¾ã£ãŸã‚‰æ‰‹ã§ãƒãƒãƒãƒã‚„ã£ã¦ãŸã‚‰è¾›ã„ã§ã™ã‚ˆã­ã€‚ã¨ã„ã†ã‚ã‘ã§ã€ä¸€æ‹¬æ‰¿èªã‚’ã—ã¡ã‚ƒã„ã¾ã—ã‚‡ã†ã€‚

## Bookmarklet ã®ä¸­èº«

å‡¦ç†å†…å®¹ã¯æ¬¡ã®ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚

1. æ‰¿èªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’å‡ºã™ãŸã‚ã®ã‚¢ãƒ­ãƒ¼ã‚’ã‚¯ãƒªãƒƒã‚¯
2. ã‚¢ãƒ­ãƒ¼ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€Œæ‰¿èªã€ã€Œå´ä¸‹ã€ãªã©ã®ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒªã‚¹ãƒˆãŒè¡¨ç¤ºã•ã‚Œã‚‹ã®ã§ã€Œæ‰¿èªã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. æ‰¿èªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã®ã§ã€Œæ‰¿èªã€ã‚¯ãƒªãƒƒã‚¯

```javascript
javascript:(
    function() {
        var arrow_interval_id = setInterval(function() {
            // click arrow
            var arrow = document.querySelector('.rowActionsPlaceHolder.slds-button.slds-button--icon-x-small.slds-button--icon-border-filled.keyboardMode--trigger');
            if (arrow) {
                arrow.click();

                // click approval dropdown
                var dropdown_interval_id = setInterval(function() {
                    var dropdown = document.querySelector('.forceActionLink');
                    if (dropdown) {
                        dropdown.click();
                        clearInterval(dropdown_interval_id); 

                        // click approval modal
                        var modal_interval_id = setInterval(function() {
                            var modal = document.querySelector('.slds-button.slds-button--neutral.modal-button-left.actionButton.uiButton--default.uiButton--brand.uiButton'); 
                            if (modal) {
                                modal.click();
                                clearInterval(modal_interval_id);
                            }
                        }, 1000);
                    }
                }, 500);
            } else {
                clearInterval(arrow_interval_id);
            }
        }, 2500);
    }
)();
```

ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ GitHub ã«ã‚¢ãƒƒãƒ—ã—ã¦ã¾ã™ã€‚
https://github.com/dskst/bookmarklet/blob/main/teamsprit/approval.js

ã‚½ãƒ¼ã‚¹ã‚’ [Closure Compiler](https://closure-compiler.appspot.com/home) ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ãŸã‚‰ Bookmarklet ã®å®Œæˆã§ã™ã€‚

### ã‚¤ã‚±ã¦ãªã„ç‚¹

- TeamSprit ã¯ DOM ã« id ãŒã‚»ãƒƒãƒˆã•ã‚Œã¦ã„ãªã„ ãƒ¼ `querySelector` ã§ãŒã‚“ã°ã‚‹ã“ã¨ã«ã€‚
- ãƒ¢ãƒ¼ãƒ€ãƒ«ã®è¡¨ç¤ºã¾ã§ãŒã‚‚ã£ã•ã‚Šã¨å‹•ã ãƒ¼ `setInterval()` ã§ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤ºã¾ã§ã®å‡¦ç†å¾…ã¡ã‚’ã™ã‚‹ã€‚é€šä¿¡ç’°å¢ƒã«ã‚ˆã£ã¦ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆæ™‚é–“ã¯èª¿æ•´ãŒå¿…è¦ã€‚

## ãŠã‚ã‚Š

Bookmarklet ã‚’ TeamSprit ã®æœªæ‰¿èªç”³è«‹ã®ç”»é¢(å‰è¿°ã®ç”»é¢ã‚­ãƒ£ãƒ—ãƒãƒ£ã®ãƒšãƒ¼ã‚¸)ã§å®Ÿè¡Œã™ã‚‹ã¨ã€æºœã¾ã£ã¦ã„ã‚‹ç”³è«‹ã‚’å…¨éƒ¨æ‰¿èªã—ã¦ãã‚Œã¾ã™ã€‚ä¸€æ‹¬æ‰¿èªã™ã‚‹ã®ã¯ã‚ˆã„ã§ã™ãŒã€ç”³è«‹ã®ä¸­èº«ã¯ã¡ã‚ƒã‚“ã¨è¦‹ã¦ãã ã•ã„ã­ã€‚